const lvl1 = {
  "Greetings and Introductions": {
    "Hello, how are you?": "Hola, ¿cómo estás?",
    "My name is [your name].": "Me llamo [tu nombre].",
    "Nice to meet you.": "Mucho gusto.",
    "Good morning.": "Buenos días.",
    "Good afternoon.": "Buenas tardes.",
    "Good evening/night.": "Buenas noches."
  },
  "Basic Questions": {
    "How are you?": "¿Qué tal?",
    "What is your name?": "¿Cómo te llamas?",
    "Where are you from?": "¿De dónde eres?",
    "How old are you?": "¿Cuántos años tienes?",
    "What time is it?": "¿Qué hora es?",
    "Can you help me?": "¿Puedes ayudarme?",
    "Where is the bathroom?": "¿Dónde está el baño?",
    "How much does this cost?": "¿Cuánto cuesta esto?",
    "Do you speak English?": "¿Hablas inglés?",
    "What is this?": "¿Qué es esto?",
    "Can you repeat that?": "¿Puedes repetir eso?"
  },
  "Common Phrases": {
    "Please.": "Por favor.",
    "Thank you.": "Gracias.",
    "You're welcome.": "De nada.",
    "Excuse me.": "Perdón.",
    "I'm sorry.": "Lo siento.",
    "Yes.": "Sí.",
    "No.": "No.",
    "I don't understand.": "No entiendo.",
    "I don't know.": "No sé.",
    "I like it.": "Me gusta.",
    "I love you.": "Te quiero.",
    "I am hungry.": "Tengo hambre.",
    "I am thirsty.": "Tengo sed.",
    "I am tired.": "Estoy cansado/cansada.",
    "I need help.": "Necesito ayuda."
  },
  "Directions and Places": {
    "Where is the hotel?": "¿Dónde está el hotel?",
    "Turn right.": "Gira a la derecha.",
    "Turn left.": "Gira a la izquierda.",
    "Go straight ahead.": "Sigue recto.",
    "Is it far?": "¿Está lejos?",
    "Is it near?": "¿Está cerca?",
    "I am lost.": "Estoy perdido/perdida."
  },
  "Shopping and Money": {
    "How much is it?": "¿Cuánto cuesta?",
    "I want to buy this.": "Quiero comprar esto.",
    "Do you accept credit cards?": "¿Aceptan tarjetas de crédito?",
    "I need a receipt.": "Necesito un recibo.",
    "Can you give me a discount?": "¿Me puede dar un descuento?",
    "Where is the market?": "¿Dónde está el mercado?",
    "What time does it open?": "¿A qué hora abre?",
    "What time does it close?": "¿A qué hora cierra?"
  },
  "Eating and Drinking": {
    "I would like a table for two.": "Quisiera una mesa para dos.",
    "Can I see the menu?": "¿Puedo ver el menú?",
    "What do you recommend?": "¿Qué me recomienda?",
    "I am a vegetarian.": "Soy vegetariano/vegetariana.",
    "The check, please.": "La cuenta, por favor.",
    "Water, please.": "Agua, por favor."
  }
}

const lvl2 = {
  "Advanced Greetings and Social Interactions": {
    "How have you been?": "¿Cómo has estado?",
    "What have you been up to?": "¿Qué has estado haciendo?",
    "Long time no see.": "Cuánto tiempo sin verte.",
    "It's a pleasure to meet you.": "Es un placer conocerte.",
    "See you later.": "Nos vemos más tarde.",
    "Take care.": "Cuídate."
  },
  "Complex Questions and Answers": {
    "How was your day?": "¿Cómo estuvo tu día?",
    "Can you explain that to me?": "¿Puedes explicármelo?",
    "What do you think about it?": "¿Qué piensas al respecto?",
    "Why did you choose that?": "¿Por qué elegiste eso?",
    "What are your plans for the weekend?": "¿Cuáles son tus planes para el fin de semana?",
    "How do you feel about it?": "¿Cómo te sientes al respecto?",
    "Can you speak more slowly?": "¿Puedes hablar más despacio?",
    "Do you have any recommendations?": "¿Tienes alguna recomendación?",
    "Could you give me some advice?": "¿Podrías darme algún consejo?",
    "What's the difference between...?": "¿Cuál es la diferencia entre...?"
  },
  "Polite Requests and Offers": {
    "Could you please help me with this?": "¿Podrías ayudarme con esto, por favor?",
    "Would you like to join us?": "¿Te gustaría unirte a nosotros?",
    "May I ask you a favor?": "¿Puedo pedirte un favor?",
    "Would you mind closing the door?": "¿Te importaría cerrar la puerta?",
    "Can I offer you something to drink?": "¿Te puedo ofrecer algo de beber?",
    "Could you lend me a hand?": "¿Podrías echarme una mano?"
  },
  "Describing People and Things": {
    "She is very kind and helpful.": "Ella es muy amable y servicial.",
    "This place is absolutely stunning.": "Este lugar es absolutamente impresionante.",
    "He seems a bit reserved.": "Él parece un poco reservado.",
    "The book is fascinating and insightful.": "El libro es fascinante y perspicaz.",
    "It's a small, cozy restaurant.": "Es un restaurante pequeño y acogedor.",
    "They are hardworking and dedicated.": "Ellos son trabajadores y dedicados."
  },
  "Expressing Feelings and Emotions": {
    "I am really excited about this.": "Estoy muy emocionado/emocionada por esto.",
    "I feel a bit nervous.": "Me siento un poco nervioso/nerviosa.",
    "I'm disappointed with the results.": "Estoy decepcionado/decepcionada con los resultados.",
    "This makes me really happy.": "Esto me hace muy feliz.",
    "I'm worried about the situation.": "Estoy preocupado/preocupada por la situación.",
    "I feel relieved.": "Me siento aliviado/aliviada."
  },
  "Time and Scheduling": {
    "What time is convenient for you?": "¿A qué hora te conviene?",
    "Could we reschedule our meeting?": "¿Podríamos reprogramar nuestra reunión?",
    "Let's meet at 10 o'clock.": "Reunámonos a las 10 en punto.",
    "I will be available tomorrow afternoon.": "Estaré disponible mañana por la tarde.",
    "Can you confirm the time?": "¿Puedes confirmar la hora?",
    "How long will the meeting last?": "¿Cuánto durará la reunión?"
  },
  "Shopping and Negotiation": {
    "Do you have this in a different size?": "¿Tienen esto en otro tamaño?",
    "Is there a warranty on this product?": "¿Hay garantía para este producto?",
    "I am looking for something specific.": "Estoy buscando algo específico.",
    "Could you offer a better price?": "¿Podrías ofrecerme un mejor precio?",
    "Can I return this if it doesn't fit?": "¿Puedo devolver esto si no me queda?",
    "Is there a discount for bulk purchases?": "¿Hay descuento para compras al por mayor?"
  },
  "Dining Out and Food Preferences": {
    "Could we get separate checks?": "¿Podríamos tener cuentas separadas?",
    "Is there a vegan option?": "¿Hay opción vegana?",
    "I would like my steak medium rare.": "Quisiera mi bistec término medio.",
    "Can I have a little less salt, please?": "¿Podría tener un poco menos de sal, por favor?",
    "Is this dish gluten-free?": "¿Este plato es sin gluten?",
    "Could I see the dessert menu?": "¿Podría ver el menú de postres?"
  },
  "Travel and Transportation": {
    "How long is the flight?": "¿Cuánto dura el vuelo?",
    "Could you recommend a good hotel?": "¿Podrías recomendarme un buen hotel?",
    "How do I get to the train station?": "¿Cómo llego a la estación de tren?",
    "Is there a shuttle service available?": "¿Hay servicio de transporte disponible?",
    "What is the best way to get there?": "¿Cuál es la mejor manera de llegar ahí?",
    "Can you book a taxi for me?": "¿Puedes reservarme un taxi?"
  },
  "Health and Emergencies": {
    "I need to see a doctor.": "Necesito ver a un médico.",
    "Where is the nearest hospital?": "¿Dónde está el hospital más cercano?",
    "I am allergic to penicillin.": "Soy alérgico/alérgica a la penicilina.",
    "Could you call an ambulance?": "¿Podrías llamar a una ambulancia?",
    "I have a prescription to fill.": "Tengo una receta para surtir.",
    "I need to buy some painkillers.": "Necesito comprar analgésicos."
  },
  "Weather and Nature": {
    "What will the weather be like tomorrow?": "¿Cómo estará el tiempo mañana?",
    "It's going to rain later today.": "Va a llover más tarde hoy.",
    "The temperature is dropping quickly.": "La temperatura está bajando rápidamente.",
    "It's a beautiful day outside.": "Es un día hermoso afuera.",
    "There is a storm approaching.": "Se aproxima una tormenta.",
    "The sunset is breathtaking.": "El atardecer es impresionante."
  },
  "Technology and Internet": {
    "Can you help me with my computer?": "¿Puedes ayudarme con mi computadora?",
    "What is the Wi-Fi password?": "¿Cuál es la contraseña del Wi-Fi?",
    "My phone is not working properly.": "Mi teléfono no está funcionando bien.",
    "Can I use your charger?": "¿Puedo usar tu cargador?",
    "How do I connect to the internet?": "¿Cómo me conecto a internet?",
    "Is there a nearby internet café?": "¿Hay un café internet cerca?"
  }
};

const lvl3 = {
  "Professional Communication": {
    "I'm interested in your professional opinion.": "Me interesa tu opinión profesional.",
    "Could you elaborate on that point?": "¿Podrías ampliar ese punto?",
    "Let's schedule a follow-up meeting.": "Programemos una reunión de seguimiento.",
    "We need to revise our strategy.": "Necesitamos revisar nuestra estrategia.",
    "What is the projected ROI?": "¿Cuál es el retorno de la inversión proyectado?",
    "Let's finalize the details.": "Finalicemos los detalles."
  },
  "Cultural Understanding": {
    "Could you explain this cultural tradition?": "¿Podrías explicar esta tradición cultural?",
    "What are the cultural norms in this situation?": "¿Cuáles son las normas culturales en esta situación?",
    "It's important to respect cultural differences.": "Es importante respetar las diferencias culturales.",
    "Let's embrace diversity.": "Aceptemos la diversidad.",
    "I appreciate learning about your culture.": "Aprecio aprender sobre tu cultura.",
    "Understanding local customs is crucial.": "Entender las costumbres locales es crucial."
  },
  "Legal and Business Terms": {
    "What are the legal implications of this decision?": "¿Cuáles son las implicaciones legales de esta decisión?",
    "We need to review the contract thoroughly.": "Necesitamos revisar el contrato detenidamente.",
    "Could you provide legal counsel on this matter?": "¿Podrías proporcionar asesoría legal sobre este asunto?",
    "Let's proceed with due diligence.": "Procedamos con diligencia debida.",
    "I recommend consulting with our legal team.": "Recomiendo consultar con nuestro equipo legal.",
    "This falls under intellectual property rights.": "Esto entra dentro de los derechos de propiedad intelectual."
  },
  "Technical and Scientific Language": {
    "What are the technical specifications?": "¿Cuáles son las especificaciones técnicas?",
    "Could you explain the scientific basis for this theory?": "¿Podrías explicar la base científica de esta teoría?",
    "Let's conduct a feasibility study.": "Realicemos un estudio de viabilidad.",
    "We need to analyze the data comprehensively.": "Necesitamos analizar los datos de manera exhaustiva.",
    "What is the technological advancement in this field?": "¿Cuál es el avance tecnológico en este campo?",
    "This requires advanced computational skills.": "Esto requiere habilidades computacionales avanzadas."
  },
  "Art and Literature Discussions": {
    "What is the artistic inspiration behind this piece?": "¿Cuál es la inspiración artística detrás de esta obra?",
    "Could you interpret the symbolism in this painting?": "¿Podrías interpretar el simbolismo en esta pintura?",
    "Let's analyze the narrative structure of this novel.": "Analicemos la estructura narrativa de esta novela.",
    "What are the prevailing themes in contemporary art?": "¿Cuáles son los temas predominantes en el arte contemporáneo?",
    "I admire the craftsmanship of this sculpture.": "Admiro la artesanía de esta escultura.",
    "This literary work has profound philosophical implications.": "Esta obra literaria tiene profundas implicaciones filosóficas."
  },
  "Environmental and Sustainability Discussions": {
    "What are the environmental ramifications of this project?": "¿Cuáles son las ramificaciones ambientales de este proyecto?",
    "Let's promote eco-friendly practices.": "Promovamos prácticas respetuosas con el medio ambiente.",
    "Could you discuss renewable energy solutions?": "¿Podrías discutir soluciones de energía renovable?",
    "What is the carbon footprint of this manufacturing process?": "¿Cuál es la huella de carbono de este proceso de fabricación?",
    "I support initiatives for biodiversity conservation.": "Apoyo las iniciativas para la conservación de la biodiversidad.",
    "It's crucial to address climate change issues.": "Es crucial abordar los problemas del cambio climático."
  },
  "Advanced Medical and Health Terms": {
    "What are the therapeutic benefits of this treatment?": "¿Cuáles son los beneficios terapéuticos de este tratamiento?",
    "Let's discuss the prognosis of the patient.": "Discutamos el pronóstico del paciente.",
    "Could you explain the pharmacological mechanism?": "¿Podrías explicar el mecanismo farmacológico?",
    "What are the ethical considerations in medical research?": "¿Cuáles son las consideraciones éticas en la investigación médica?",
    "I advocate for mental health awareness.": "Abogo por la conciencia de la salud mental.",
    "This requires expertise in epidemiology.": "Esto requiere experiencia en epidemiología."
  }
};

const lvl4 = {
  "Advanced Business and Management": {
    "What are the key performance indicators (KPIs) for this project?": "¿Cuáles son los indicadores clave de rendimiento (KPI) para este proyecto?",
    "Let's discuss the strategic implementation of our marketing plan.": "Hablemos sobre la implementación estratégica de nuestro plan de marketing.",
    "What are the implications of global supply chain disruptions on manufacturing?": "¿Cuáles son las implicaciones de las interrupciones en la cadena de suministro global en la manufactura?",
    "Could you analyze the feasibility study for this new product launch?": "¿Podrías analizar el estudio de viabilidad para el lanzamiento de este nuevo producto?",
    "Let's brainstorm ideas for enhancing customer engagement and retention.": "Vamos a generar ideas para mejorar el compromiso y retención de clientes.",
    "This company needs to streamline its operational processes to improve efficiency.": "Esta empresa necesita optimizar sus procesos operativos para mejorar la eficiencia."
  },
  "Advanced Academic and Research": {
    "What methodologies are appropriate for this interdisciplinary research study?": "¿Qué metodologías son apropiadas para este estudio de investigación interdisciplinario?",
    "Let's delve into the theoretical framework of quantum physics.": "Profundicemos en el marco teórico de la física cuántica.",
    "Could you elucidate the findings of your empirical research?": "¿Podrías elucidar los hallazgos de tu investigación empírica?",
    "What are the ethical considerations in conducting social science experiments?": "¿Cuáles son las consideraciones éticas en la realización de experimentos en ciencias sociales?",
    "Let's analyze the implications of this mathematical model in economic forecasting.": "Analicemos las implicaciones de este modelo matemático en la predicción económica.",
    "This paper proposes a novel approach to addressing climate change mitigation strategies.": "Este documento propone un enfoque novedoso para abordar estrategias de mitigación del cambio climático."
  },
  "Advanced Legal and Political": {
    "What are the constitutional implications of this court ruling?": "¿Cuáles son las implicaciones constitucionales de esta decisión judicial?",
    "Let's examine the geopolitical factors influencing international trade agreements.": "Examinemos los factores geopolíticos que influyen en los acuerdos comerciales internacionales.",
    "Could you elaborate on the legislative amendments proposed in the recent session?": "¿Podrías ampliar sobre las enmiendas legislativas propuestas en la sesión reciente?",
    "What is the judicial precedent for cases involving intellectual property disputes?": "¿Cuál es el precedente judicial para casos que involucran disputas de propiedad intelectual?",
    "Let's discuss the ramifications of this policy decision on environmental conservation efforts.": "Hablemos sobre las ramificaciones de esta decisión política en los esfuerzos de conservación ambiental.",
    "This diplomatic negotiation requires a nuanced understanding of international relations.": "Esta negociación diplomática requiere una comprensión matizada de las relaciones internacionales."
  }
};

const lvl5 = {
  "Advanced Scientific and Technical": {
    "Quantum entanglement theory": "Teoría de la entrelazación cuántica",
    "Neurodegenerative diseases research": "Investigación de enfermedades neurodegenerativas",
    "Genetic engineering and biotechnology advancements": "Avances en ingeniería genética y biotecnología",
    "Artificial intelligence and machine learning algorithms": "Algoritmos de inteligencia artificial y aprendizaje automático",
    "Climate change mitigation strategies": "Estrategias de mitigación del cambio climático",
    "Nanotechnology applications in medicine": "Aplicaciones de la nanotecnología en medicina"
  },
  "Advanced Economic and Financial": {
    "Macroeconomic indicators and fiscal policy": "Indicadores macroeconómicos y política fiscal",
    "Derivatives trading strategies": "Estrategias de negociación de derivados",
    "Corporate finance and capital restructuring": "Finanzas corporativas y reestructuración de capital",
    "Global economic recession analysis": "Análisis de la recesión económica global",
    "Cryptocurrency market trends and blockchain technology": "Tendencias del mercado de criptomonedas y tecnología blockchain",
    "Sustainable development finance models": "Modelos de financiamiento para el desarrollo sostenible"
  },
  "Advanced Medical and Healthcare": {
    "Precision medicine and personalized healthcare": "Medicina de precisión y atención médica personalizada",
    "Neurosurgical innovations and procedures": "Innovaciones y procedimientos neuroquirúrgicos",
    "Public health epidemiology and disease surveillance": "Epidemiología de salud pública y vigilancia de enfermedades",
    "Biomedical engineering advancements": "Avances en ingeniería biomédica",
    "Pharmaceutical regulatory compliance": "Cumplimiento normativo farmacéutico",
    "Healthcare informatics and digital health technologies": "Informática en salud y tecnologías digitales de salud"
  },
  "Advanced Legal and International Relations": {
    "International human rights law and humanitarian interventions": "Derecho internacional de los derechos humanos e intervenciones humanitarias",
    "War crimes tribunal and international justice": "Tribunal de crímenes de guerra y justicia internacional",
    "Intellectual property rights and global trade agreements": "Derechos de propiedad intelectual y acuerdos comerciales globales",
    "Diplomatic negotiations and multilateral diplomacy": "Negociaciones diplomáticas y diplomacia multilateral",
    "Environmental law and sustainable development treaties": "Derecho ambiental y tratados de desarrollo sostenible",
    "International trade disputes and arbitration": "Disputas comerciales internacionales y arbitraje"
  }
};





var score = 0;
let currentSentence = { spanishSentence: "", englishTranslation: "" };
let isRunning = false; // Flag to check if the game is running
let gameOver = false; 

var correct = new Audio("./soundEffects/correct.mp3");
var incorrect = new Audio("./soundEffects/incorrect.mp3");




// Function to get a random sentence from the dictionary
function getRandomSentence() {
    const categories = Object.keys(lvl1);
    const randomCategory = categories[Math.floor(Math.random() * categories.length)];
    const phrases = lvl1[randomCategory];
    const keys = Object.keys(phrases);
    const randomKey = keys[Math.floor(Math.random() * keys.length)];
    const spanishSentence = phrases[randomKey];
    const englishTranslation = randomKey;

    return { spanishSentence, englishTranslation };
}

$('.ai-button').click(function() { 
  $('.api-response').toggleClass('api-response-show');

  
});


// Click event for submit button
$('.button').click(function() {
    $('.scoreboard').removeClass("scoreboard-show"); 
    if (!isRunning) {
        $('.api-response').html("Please start the game first!");
        return;
    }
    
    var userInput = $('.input').val();
    const apiRequestMessage = `Is "${userInput}" the English translation of "${currentSentence.spanishSentence}"?`;

    // Display loading message
    $('.api-response').html("Loading AI response...🔃");

    $.ajax({
        url: '/message',
        type: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({ message: apiRequestMessage }),
        success: function(data) {
            // Check if the response indicates the translation is correct
            if (data.response.toLowerCase().includes('correct')) {
                score += 1;
                correct.play();
                // Generate a new random sentence
                currentSentence = getRandomSentence();
                $('.output').html(currentSentence.spanishSentence);
                $('.input').val(""); // Clear the input field
            } else { 
                incorrect.play(); 
                $('.input').val(""); // Clear the input field
            }

            // Update the score and display the API response
            $('.score').html("SCORE: " + score);
            $('.api-response').html(data.response);
        },
        error: function(error) {
            console.error('Error:', error);
            $('.api-response').html("An error occurred. Please try again.");
        }
    });
});

// Click event for start button
$('.start-button').click(function() {
    if (isRunning) return; // Prevent further clicks if the game is running

    // Generate and display a new random sentence
    currentSentence = getRandomSentence();
    $('.output').html(currentSentence.spanishSentence);
    isRunning = true; // Set the running flag
    $(this).addClass("start-button-pressed");
    $(this).prop('disabled', true); // Disable the button

    let timeLeft = 60; // Initial time in seconds

    // Function to format the time in "TIME: MM:SS" format
    function formatTime(seconds) {
        let minutes = Math.floor(seconds / 60); // Calculate minutes
        let remainingSeconds = seconds % 60; // Calculate remaining seconds
        return `TIME: ${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`; // Format as "TIME: M:SS"
    }

    // Display initial formatted time
    $('.time').html(formatTime(timeLeft));

    // Function to update the time every second
    let countdown = setInterval(function() {
        timeLeft--; // Decrease time by one second
        $('.time').html(formatTime(timeLeft)); // Update the displayed time

        if (timeLeft <= 0) {
            $('.scoreboard').addClass("scoreboard-show"); 
            $("#final-score").html(score); // Display final score)
            clearInterval(countdown); // Stop the countdown when time is up
            $('.time').html('TIME: 0:00'); // Optionally display "TIME: 0:00"
            isRunning = false; // Reset the running flag
            $('.input').val(""); // Clear the input field
            $('.output').html("Press 'START' para comenzar el TuCan Translate ✨"); 
            $(".api-response").html("¡Hola! I am tu AI assistant. I'll be helping you con hints y explicaciones en your respuestas. ¡You got this!🙌"); // Clear the output field
            $('.start-button').prop('disabled', false); // Enable the button again
            $('.start-button').removeClass("start-button-pressed"); // Reset button style
        }
    }, 1000); // Interval of 1 second (1000 milliseconds)
});

$('.final-button').click(function() { 
    $('.scoreboard').removeClass("scoreboard-show"); 
});



// Function to generate a random Spanish sentence
function randomSentence() {
    var flattenedSentences = [];
    for (var category in lvl1) {
        if (lvl1.hasOwnProperty(category)) {
            for (var phrase in lvl1[category]) {
                if (lvl1[category].hasOwnProperty(phrase)) {
                    flattenedSentences.push(lvl1[category][phrase]);
                }
            }
        }
    }

    // Generate a random index
    var randomIndex = Math.floor(Math.random() * flattenedSentences.length);

    // Access the random sentence
    var randomSentence = flattenedSentences[randomIndex];

    return randomSentence;
}

// Function to prepare the API request message
function prepareAPIRequest(userInput) {
    const { spanishSentence, englishTranslation } = getRandomSentence();
    const apiMessage = `Is "${userInput}" the English translation of "${spanishSentence}"?`;
    return apiMessage;
}


function getCookie(name) {
  let cookieArr = document.cookie.split(";");
  for(let i = 0; i < cookieArr.length; i++) {
      let cookiePair = cookieArr[i].split("=");
      if(name == cookiePair[0].trim()) {
          return decodeURIComponent(cookiePair[1]);
      }
  }
  
  return null;
}

language = getCookie('language');
if (language == "Spanish") {
  document.querySelectorAll(".menu").item(0).outerHTML = '\
              <div class="menu"> \
                  <button class="menu-button">Menú</button> \
                  <ul class="menu-items"><li><a href="/">Página Principal</a></li> \
                  <li><a href="/flight">Tucan Volar</a></li> \
                  <li><a href="/draw">Tucan Dibujar</a></li> \
                  <li><a href="/speak">Tucan Hablar</a></li> \
                  <li><a href="/write">Tucan Traducir</a></li> \
                  <li><a href="javascript:void(0);" onclick="return changeLanguage()">Change Language</a></li> \
                  <li><a href="javascript:void(0);" onclick="return signOut()">Desconectar</a></li></ul> \
              </div>';
}